Rank books by rating within each year.

Calculate the average rating per author, then rank authors by average rating.

Find publishers whose average votes per book exceed 5000.

Compute the cumulative total of votes ordered by year.

List the top-rated book per publisher using a window function